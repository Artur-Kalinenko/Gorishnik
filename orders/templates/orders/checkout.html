{% extends "base.html" %}
{% load static %}

{% block content %}
<div class="container mt-5">
    <h2>Оформлення замовлення</h2>

    {% if error %}
        <div class="alert alert-warning">{{ error }}</div>
    {% endif %}

    <form method="post">
        {% csrf_token %}

        <!-- Поля формы -->
        {{ form.full_name.label_tag }}
        {{ form.full_name }}

        {{ form.phone.label_tag }}
        {{ form.phone }}

        {{ form.email.label_tag }}
        {{ form.email }}

        <!-- Спосіб доставки -->
        <div class="form-group">
            <label>Спосіб доставки:</label><br>
            <label><input type="radio" name="delivery_method" value="nova_poshta" checked> Нова Пошта</label><br>
            <label><input type="radio" name="delivery_method" value="ukr_poshta"> Укрпошта</label><br>
            <label><input type="radio" name="delivery_method" value="pickup"> Самовивіз</label>
        </div>

        <!-- Поля для Новой Пошты -->
        <div id="nova-poshta-fields">
            <div class="form-group">
                <label for="id_city">Місто (Нова Пошта):</label>
                <select id="id_city" name="city" class="form-control"></select>
            </div>
            <div class="form-group">
                <label for="id_warehouse">Відділення (Нова Пошта):</label>
                <select id="id_warehouse" name="warehouse" class="form-control"></select>
            </div>
        </div>

        <!-- Поля для Укрпошти -->
        <div id="ukr-poshta-fields" style="display:none;">
            <div class="form-group">
                <label for="ukr_city">Місто:</label>
                <input type="text" name="ukr_city" id="ukr_city" class="form-control">
            </div>
            <div class="form-group">
                <label for="ukr_address">Адреса відділення:</label>
                <input type="text" name="ukr_address" id="ukr_address" class="form-control">
            </div>
        </div>

        <!-- Скрытые поля для отправки рефов -->
        <input type="hidden" name="city_ref" id="hidden_city_ref">
        <input type="hidden" name="warehouse_ref" id="hidden_warehouse_ref">

        <button type="submit" class="btn btn-success">Відправити замовлення</button>
    </form>
</div>
<!-- jQuery -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<!-- Select2 (рабочий CDN) -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/css/select2.min.css" rel="stylesheet" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/js/select2.min.js"></script>

<!-- Твой скрипт -->
<script src="{% static 'orders/checkout.js' %}"></script>
{% endblock %}

