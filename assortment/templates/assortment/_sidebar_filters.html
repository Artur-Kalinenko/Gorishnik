<form method="get" id="filter-form">
    {% if selected_category %}
        <input type="hidden" name="category" value="{{ selected_category }}">
    {% endif %}
    {% if query %}
        <input type="hidden" name="q" value="{{ query }}">
    {% endif %}

    <!-- üîΩ –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã -->
    <div class="filter-group mb-3">
        <h5 class="filter-header">–î–æ–¥–∞—Ç–∫–æ–≤–æ</h5>
        <div class="filter-options">
<!--            <div class="form-check mb-1">-->
<!--                <input class="form-check-input" type="checkbox" name="discounted" value="1"-->
<!--                       {% if request.GET.discounted %}checked{% endif %}>-->
<!--                <label class="form-check-label">–ê–∫—Ü—ñ–π–Ω—ñ –ø—Ä–æ–ø–æ–∑–∏—Ü—ñ—ó</label>-->
<!--            </div>-->
            <div class="form-check mb-1">
                <input class="form-check-input" type="checkbox" name="new" value="1"
                       {% if request.GET.new %}checked{% endif %}>
                <label class="form-check-label">–ù–æ–≤–∏–Ω–∫–∏</label>
            </div>
            {% if user.is_authenticated %}
            <div class="form-check mb-1">
                <input class="form-check-input" type="checkbox" name="my_favorites" value="1"
                       {% if request.GET.my_favorites == "1" %}checked{% endif %}>
                <label class="form-check-label">–ú–æ—ó –æ–±—Ä–∞–Ω—ñ —Ç–æ–≤–∞—Ä–∏</label>
            </div>
        {% endif %}

        </div>
    </div>

    <!-- üîΩ –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã -->
    {% for group in filter_groups %}
        <div class="filter-group mb-3">
            <h5 class="filter-header d-flex justify-content-between align-items-center"
                data-group-id="{{ group.id }}" style="cursor: pointer;">
                {{ group.name }}
                <span class="toggle-icon" id="icon-{{ group.id }}">+</span>
            </h5>
            <div class="filter-options" id="group-{{ group.id }}" style="display: none;">
                {% for option in group.options.all %}
                    <div class="form-check mb-1">
                        <input class="form-check-input" type="checkbox" name="filters" value="{{ option.id }}"
                               {% if option.id in selected_filter_ids %}checked{% endif %}>
                        <label class="form-check-label">
                            {{ option.name }} ({{ option.count_in_category }})
                        </label>
                    </div>
                {% endfor %}
            </div>
        </div>
    {% endfor %}

    {% if active_producers %}
        <div class="filter-group mb-3">
            <h5 class="filter-header">–í–∏—Ä–æ–±–Ω–∏–∫–∏</h5>
            <div class="d-flex flex-wrap gap-2">
                {% for producer in active_producers %}
                    <label style="cursor: pointer; opacity: {% if producer.id|stringformat:'s' in selected_producer_ids %}1{% else %}0.4{% endif %};">
                        <input type="checkbox" name="producer" value="{{ producer.id }}"
                               class="d-none"
                               {% if producer.id|stringformat:"s" in selected_producer_ids %}checked{% endif %}>
                        <img src="{{ producer.producer_img.url }}"
                             alt="{{ producer.producer_name }}"
                             style="height: 50px; width: 50px; object-fit: contain;">
                    </label>
                {% endfor %}
            </div>
        </div>
    {% endif %}


    <button type="button" id="clear-filters" class="btn btn-outline-danger mt-4">
        –û—á–∏—Å—Ç–∏—Ç–∏ —Ñ—ñ–ª—å—Ç—Ä–∏
    </button>
</form>
