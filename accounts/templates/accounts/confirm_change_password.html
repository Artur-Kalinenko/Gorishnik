{% extends "base.html" %}
{% load static %}

{% block title %}Підтвердження зміни пароля{% endblock %}

{% block content %}
<div class="container mt-5">
    <h2 class="mb-4">Підтвердження зміни пароля</h2>
    <p>Ми надіслали код підтвердження на ваш email. Введіть його, щоб підтвердити зміну пароля.</p>

    {% if messages %}
        {% for message in messages %}
            <div class="alert alert-{{ message.tags }}">{{ message }}</div>
        {% endfor %}
    {% endif %}

    <!-- Форма підтвердження коду -->
    <form method="post" id="confirm-form">
        {% csrf_token %}
        {{ form.non_field_errors }}

        <div class="mb-3">
            {{ form.code.label_tag }}
            {{ form.code }}
            {% if form.code.errors %}
                <div class="text-danger small">{{ form.code.errors.0 }}</div>
            {% endif %}
        </div>

        <button type="submit" class="btn btn-primary">Підтвердити</button>
    </form>

    <!-- Форма повторної відправки коду -->
    <form method="post" class="mt-2 d-inline-block" id="resend-form">
        {% csrf_token %}
        <input type="hidden" name="resend" value="1">
        <button type="submit"
                id="resend-code-btn"
                class="btn btn-link p-0"
                data-code-resend
                data-sent-at="{{ request.session.change_password.sent_at|default:'' }}"
                data-is-first="{{ request.session.change_password.is_first|yesno:'true,false' }}">
            Надіслати код повторно
        </button>
        <span id="timer-placeholder" class="ms-2 text-muted"></span>
    </form>
</div>

<script src="{% static 'accounts/code_verification.js' %}"></script>
{% endblock %}
